# Generated by Ansible : {{ template_run_date }}
# This is a minimal configuration file, which allows the bird daemon to start
# but will not cause anything else to happen.
#
# Please refer to the documentation in the bird-doc package or BIRD User's
# Guide on http://bird.network.cz/ for more information on configuring BIRD and
# adding routing protocols.

# Change this into your BIRD router ID. It's a world-wide unique identification
# of your router, usually one of router's IPv4 addresses.
router id {{ ansible_eth0.ipv4.address }};


filter ospf_filter {
	if net ~ {{ netid }}/{{ netid_maskbit }} then accept;
		else reject;
}

# The Kernel protocol is not a real routing protocol. Instead of communicating
# with other routers in the network, it performs synchronization of BIRD's
# routing tables with the OS kernel.
protocol kernel {
        scan time 30;
        import filter ospf_filter;
#       export all;   # Actually insert routes into the kernel routing table
}

# The Device protocol is not a real routing protocol. It doesn't generate any
# routes and it only serves as a module for getting information about network
# interfaces from the kernel.
protocol device {
        scan time 10;
}

log syslog all;
timeformat protocol iso long;

protocol ospf{
        area {{ ospf_area[""+rackskab] }} {
                stub yes;
		stubnet {{ netid }}/{{ netid_maskbit }} { summary; };
				networks {
						{{ netid }}/{{ netid_maskbit }};
				};
                interface "eth0" {
                        type broadcast;
                        hello 5;
                        dead 20;
                        wait 20;
                        retransmit 2;
                };
        };
}
