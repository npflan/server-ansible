#!/bin/bash

if [ "$1" = '--host' ]; then
  echo "{}"
  exit 0
fi

addresses=$(nmap --min-parallelism 15 --min-rate 5000 -p 22 10.100.103,106,107.11-250 | grep -Eo "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"|grep -v "10\.100\.107\.10")

output="{\n"
output="${output}  \"npf_gameservers\": [\n"

while read -r address; do
  output="${output}    \"${address}\",\n"
done <<< "$addresses"

output="${output} ]\n}"

echo -e `echo $output | sed 's/\(.*\),/\1/'`
